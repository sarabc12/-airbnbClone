<h1>Flat Details</h1>
<div class="flat-container" style="display: flex; align-items: flex-start; gap: 20px;">
  <img src="<%= @flat.image_url %>" alt="Flat picture" style="max-width: 400px; height: auto;" >
  <div class="flat-info" style="flex: 1;">
    <p><%= @flat.picture %></p>
    <p><strong><%= @flat.title %></strong></p>
    <p><%= @flat.address %></p>
    <p><%= @flat.description %></p>
    <p><%= @flat.price %></p>
    <% @flat.pictures.each do |picture| %>
      <%= cl_image_tag picture.key, height: 300, width: 400, crop: :fill %>
    <% end %>
  </div>
</div>
<%= link_to "Delete", flat_path(@flat), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>

<h2>Book This Flat</h2>
<%= simple_form_for [@flat, @booking] do |f| %>
  <%= f.input :start_date, as: :string, input_html: { data: { controller: "datepicker" } } %>
  <%= f.input :end_date, as: :string, input_html: { data: { controller: "datepicker" } } %>
  <%= f.submit "Book Now", class: "btn btn-success" %>
<% end %>

<h3>Existing Bookings</h3>
<ul>
  <% @flat.bookings.each do |booking| %>
    <li>Booked by <%= booking.user.email %> from <%= booking.start_date %> to <%= booking.end_date %>
      <%= link_to "Cancel", booking_path(booking), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "btn bnt-danger" %>
    </li>
  <% end %>
</ul>



<div style="width: 100%; height: 600px;"
  data-controller="map"
  data-map-markers-value="<%= @marker.to_json %>"
  data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>"></div>
